<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Hover Autoplay Test</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-4xl mx-auto">
        <h1 class="text-3xl font-bold mb-8 text-center">Hover Autoplay Debug Test</h1>
        
        <div class="bg-white p-6 rounded-lg shadow-lg mb-8">
            <h2 class="text-xl font-semibold mb-4">Instructions:</h2>
            <ol class="list-decimal list-inside space-y-2">
                <li>Go to <a href="http://localhost:3000/search?q=halo" class="text-blue-600 underline" target="_blank">http://localhost:3000/search?q=halo</a></li>
                <li>Open browser developer console (F12)</li>
                <li>Copy and paste the debug script below into the console</li>
                <li>Check the console output for detailed debugging information</li>
                <li>Try hovering over video cards manually to test the functionality</li>
            </ol>
        </div>

        <div class="bg-gray-900 text-white p-4 rounded-lg">
            <h3 class="text-lg font-semibold mb-2 text-green-400">Debug Script (Copy this to browser console):</h3>
            <pre class="text-sm overflow-x-auto"><code>// Debug script for hover autoplay
console.log('üîç Starting Hover Autoplay Debug');

// Wait for page load
setTimeout(() => {
  console.log('üìç Current URL:', window.location.href);
  
  // Check for video cards
  const videoCards = document.querySelectorAll('[class*="group cursor-pointer"]');
  console.log('üìπ Video cards found:', videoCards.length);
  
  if (videoCards.length > 0) {
    const firstCard = videoCards[0];
    
    // Check structure
    const thumbnail = firstCard.querySelector('img[alt]');
    const watchLink = firstCard.querySelector('a[href*="/watch/"]');
    
    console.log('üñºÔ∏è Thumbnail:', !!thumbnail);
    console.log('üîó Watch link:', !!watchLink);
    
    if (watchLink) {
      const videoId = watchLink.href.match(/\/watch\/(.+)$/)?.[1];
      console.log('üÜî Raw video ID:', videoId);
      
      // Test ID extraction logic
      let extractedId = null;
      if (videoId?.startsWith('youtube-')) {
        extractedId = videoId.replace('youtube-', '');
      } else if (videoId?.startsWith('google-search-')) {
        extractedId = videoId.replace('google-search-', '');
      } else if (videoId?.length === 11 && /^[a-zA-Z0-9_-]+$/.test(videoId)) {
        extractedId = videoId;
      }
      
      console.log('üé¨ Extracted YouTube ID:', extractedId);
      console.log('‚úÖ Valid for autoplay:', extractedId && extractedId.length === 11);
      
      if (extractedId && extractedId.length === 11) {
        console.log('üéØ Testing hover...');
        
        // Simulate hover
        firstCard.dispatchEvent(new MouseEvent('mouseenter', { bubbles: true }));
        
        setTimeout(() => {
          const badge = firstCard.querySelector('[class*="bg-red-600"]');
          console.log('üè∑Ô∏è Preview badge:', !!badge);
          
          setTimeout(() => {
            const iframe = firstCard.querySelector('iframe[src*="youtube-nocookie.com"]');
            console.log('üé¨ Iframe loaded:', !!iframe);
            
            if (iframe) {
              console.log('‚úÖ SUCCESS! Iframe src:', iframe.src);
            } else {
              console.log('‚ùå No iframe found');
            }
            
            // Clean up
            firstCard.dispatchEvent(new MouseEvent('mouseleave', { bubbles: true }));
          }, 700);
        }, 200);
      } else {
        console.log('‚ùå Invalid video ID - hover won\'t work');
      }
    }
  } else {
    console.log('‚ùå No video cards found');
  }
}, 2000);

console.log('‚úÖ Debug script loaded - waiting 2 seconds for page...');</code></pre>
        </div>

        <div class="mt-8 bg-yellow-50 border border-yellow-200 p-4 rounded-lg">
            <h3 class="text-lg font-semibold text-yellow-800 mb-2">Common Issues & Solutions:</h3>
            <div class="space-y-3 text-yellow-700">
                <div><strong>1. No video cards found:</strong> Search results may not have loaded yet. Wait longer or refresh.</div>
                <div><strong>2. Invalid video ID:</strong> The search API might be returning non-YouTube video IDs. Check the API response.</div>
                <div><strong>3. Iframe not loading:</strong> Browser might be blocking autoplay or the specific video isn't embeddable.</div>
                <div><strong>4. Preview badge not appearing:</strong> Hover state logic might not be working correctly.</div>
            </div>
        </div>

        <div class="mt-8 bg-blue-50 border border-blue-200 p-4 rounded-lg">
            <h3 class="text-lg font-semibold text-blue-800 mb-2">Expected Behavior:</h3>
            <div class="space-y-2 text-blue-700">
                <div>‚úÖ Hover over video card</div>
                <div>‚úÖ Wait 0.5 seconds</div>
                <div>‚úÖ See red "Preview" badge appear</div>
                <div>‚úÖ See YouTube iframe load and autoplay (muted)</div>
                <div>‚úÖ Move cursor away to return to thumbnail</div>
            </div>
        </div>
    </div>
</body>
</html>
